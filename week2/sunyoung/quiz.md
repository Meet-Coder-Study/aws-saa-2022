# 고가용성 및 스케일링성: ELB 및 ASG

# 퀴즈

### 1)

> EC2 인스턴스를r4.large에서 r4.4xlarge로 스케일링하는 것을 (~)이라 합니다.
> 

```
1. 수평 스케일링성
2. 수직 스케일링성
```

```
선택) 2. 수직 스케일링성
정답) 2. 수직 스케일링성

해설) 수직 스케일링성(scale up)이 스펙을 높이는 것, 수평 스케일링성(scale out)이 개수를 늘리는 것이다.
```

### 2)

> EC2 인스턴스 수를 스케일링 및 축소하는 오토 스케일링 그룹 (ASG)에서 애플리케이션을 실행하는 것을 (~)라고 합니다.
> 

```
1. 수평 스케일링성
2. 수직 스케일링성
```

```
선택) 1. 수평 스케일링성
정답) 1. 수평 스케일링성

해설) ASG에서 인스턴스의 개수를 조정하는 것은 수평 스케일링성(scale out/in)이다.
```

### 3)

> Elastic Load Balancer는 (~)을 제공합니다
> 

```
1. 애플리케이션에서 사용할 수 있는 정적 IPv4
2. 애플리케이션에서 사용할 수 있는 정적 DNS 이름
3. 애플리케이션에서 사용할 수 있는 정적 IPv6
```

```
선택) 2. 애플리케이션에서 사용할 수 있는 정적 DNS 이름
정답) 2. 애플리케이션에서 사용할 수 있는 정적 DNS 이름

해설) ELB에서는 기본적으로 DNS를 제공하기 때문에 ELB를 만들면 생성되는 DNS로 접근할 수 있다. 
```

### 4)

> 여러분은 ELB 하나에 EC2 인스턴스 10개로 웹 사이트를 실행 중 입니다. 사용자들로부터 페이지 사이를 이동할 때 마다 재인증을 해야하는 것에 대해서 컴플레인이 들어오고 있습니다. 한 개의 EC2 인스턴스가 있는 개발 환경과 컴퓨터에서 웹페이지는 정상적으로 작동하기 때문에 여러분은 혼란에 빠졌습니다. 이 현상의 발생 이유는 무엇일까요?
> 

```
1. 여러 EC2 인스턴스에서 호스팅할 때 웹 사이트에 문제가 있습니다.
2. EC2 인스턴스는 사용자가 자신의 IP 주소를 볼 수 없기 때문에 로그아웃하는 대신 ELB IP 주소를 수신합니다.
3. ELB에 Sticky Session이 활성화되어 있지 않습니다.
```

```
선택) 3. ELB에 Sticky Session이 활성화되어 있지 않습니다.
정답) 3. ELB에 Sticky Session이 활성화되어 있지 않습니다.

해설) Sticky Session을 활성화해야 클라이언트마다 항상 동일한 대상으로 전달할 수 있다. 
문제에서 설명하는 것은 세션이 유지되어야하는 경우이기 때문에, Sticky Session을 사용하면 클라이언트별로 세션을 유지할 수 있다.
```

### 5)

> 여러분은 ALB를 사용하여 EC2 인스턴스에서 호스팅되는 웹 사이트의 트래픽을 분산하고 있고 웹 사이트는 실제로 ALB의 IP 주소인 프라이빗 IPv4 주소에서 오는 트래픽만 인식하는 것으로 나타났습니다. 이때 웹사이트에 연결된 클라이언트의 IP 주소를 얻으려면 어떻게 해야 할까요?
> 

```
1. 사용자가 모든 요청에서 자신의 IP를 보내도록 웹사이트의 프런트엔드를 수정합니다.
2. X-Forwarded-For 헤더에서 클라이언트 IP 주소를 가져오도록 웹사이트의 백엔드를 수정합니다.
3. 웹사이트의 백엔드를 수정하여 X-Forwarded-Port 헤더에서 클라이언트 IP 주소를 가져옵니다.
4. 웹사이트의 백엔드를 수정하여 X-Forwarded-Proto 헤더에서 클라이언트 IP 주소를 가져옵니다.
```

```
선택) 2. X-Forwarded-For 헤더에서 클라이언트 IP 주소를 가져오도록 웹사이트의 백엔드를 수정합니다.
정답) 2. X-Forwarded-For 헤더에서 클라이언트 IP 주소를 가져오도록 웹사이트의 백엔드를 수정합니다.

해설) 헤더의 X-Forwarded-For에 IP 주소를, X-Forwarded-Port에 포트를, X-Forwarded-Proto에 프로토를 담아 보내기 때문에
클라이언트의 IP주소를 얻기 위해서는 X-Forwarded-For라는 이름의 추가 헤더가 필요하다.
```

### 6)

> 여러분은 ELB 하나와 EC2 인스턴스 집합으로 애플리케이션을 호스팅하였습니다. 일주일 후, 유저들은 애플리케이션이 간헐적으로 작동을 멈춘다고 컴플레인을 하기 시작합니다. 조사 결과, 일부 EC2 인스턴스가 때때로 충돌하는 것을 발견했습니다. 이때 사용자가 충돌하는 EC2 인스턴스에 연결하지 못하도록 보호하려면 어떻게 해야 할까요?
> 

```
1. ELB Health Checks 활성화
2. ELB Stickiness 활성화
3. SSL Termination 활성화
4. Cross-Zone Load Balancing 활성화
```

```
선택) 1. ELB Health Checks 활성화
정답) 1. ELB Health Checks 활성화

해설) EC2 인스턴스가 충돌을 하게 되면 unhealthy한 상태가 될것이고, 로드밸런서단에서 Health Check를 활성화하면 unhealthy한 인스턴스에게는 트래픽을 보내지 않게 할 수 있다.
```

### 7)

> 여러분은 솔루션 아키텍트로써 초당 수백만 건의 요청을 수신할 고성능, 저지연 시간 애플리케이션을 위한 아키텍처를 설계하려 합니다. 이때 어떤 유형의 ELB를 선택해야 할까요?
> 

```
1. Application Load Balancer (ALB)
2. Classic Load Balancer (CLB)
3. Network Load Balancer (NLB)
```

```
선택) 3. Network Load Balancer (NLB)
정답) 3. Network Load Balancer (NLB)

해설) TCP/UDP 연결을 base로 하는 NLB는 ALB에 비해 훨씬 빠른 성능을 가지고 있다.
```

### 8)

> Application Load Balancer (ALB)가 지원하는 프로토콜이 아닌것은?
> 

```
1. HTTP
2. HTTPS
3. TCP
4. WebSocket
```

```
선택) 3. TCP
정답) 3. TCP

해설) TCP는 NLB
```

### 9)

> ALB는 일정 기준에 따라 트래픽을 다른 대상 그룹으로 라우팅할 수 있습니다. 이 기준에 해당하지 않는 것은?
> 

```
1. 고객의 위치(지역)
2. 호스트 이름
3. 요청 URL 경로
4. 소스 IP-주소
```

```
선택) 1. 고객의 위치(지역)
정답) 1. 고객의 위치(지역)

해설) 호스트 이름, 요청 URL 경로, 소스의 IP 주소로 트래픽을 라우팅할 수 있지만 지역에 따라 라우팅하는 것은 불가능하다.
```

### 10)

> 다음 중 ALB의 대상 그룹에 등록된 대상이 아닌 것은?
> 

```
1. EC2 인스턴스
2. Network Load Balancer (NLB)
3. 비공개 IP 주소
4. Lambda Functions
```

```
선택) 2. Network Load Balancer (NLB)
정답) 2. Network Load Balancer (NLB)

해설) 고정 IP를 사용하기 위해 NLB의 대상 그룹으로 ALB가 될수는 있지만, ALB의 대상 그룹으로 NLB는 불가능하다.
```

### 11)

> 여러분은 규정 준수를 위해 최종 사용자에게 고정 IP 주소를 노출하여 규제 기관에서 승인한 안정적인 방화벽 규칙을 작성하도록 하려 합니다. 어떤 유형의 ELB를 선택하시겠습니까
> 

```
1. 탄력적 IP가 연결된 ALB
2. Network Load Balancer (NLB)
3. Classic Load Balancer (CLB)
```

```
선택) 2. Network Load Balancer (NLB)
정답) 2. Network Load Balancer (NLB)

해설) NLB에는 AZ당 고정 IP가 하나씩 할당된다.
```

### 12)

> 다음 중 애플리케이션 로드 밸런서 (ALB)에서 사용자 지정 애플리케이션 기반 쿠키를 생성 시 쿠키 이름으로 사용할 수 있는 것은 무엇일까요?
> 

```
1. AWSALBAPP
2. APPUSERC
3. AWSALBTG
4. AWSALB
```

```
선택) 2. APPUSERC
정답) 2. APPUSERC

해설) AWSALBAPP, AWSALBTG, AWSALB는 AWS가 사용하고 있는 쿠키 이름이다.
```

### 13)

> 여러분은 `us-east-1`의 EC2 인스턴스 세트에 트래픽을 분산하는 네트워크 로드 밸런서 (NLB)가 있습니다. `us-east-1b` AZ에 2개의 EC2 인스턴스와 `us-east-1e` AZ에 5개의 EC2 인스턴스가 있습니다. `us-east-1b` AZ의 EC2 인스턴스에서 CPU 사용률이 더 높다는 것을 확인했습니다. 추가 조사 후 트래픽이 두 AZ에 균등하게 분산되어 있음을 알 수 있습니다. 이 문제를 어떻게 해결하시겠습니까?
> 

```
1. Cross-Zone Load Balancing 활성화
2. Sticky Session 활성화
3. ELB Health Checks 활성화
4. SSL Termination 활성화
```

```
선택) 1. Cross-Zone Load Balancing 활성화
정답) 1. Cross-Zone Load Balancing 활성화

해설) Cross-Zone Load Balancing을 사용하면 AZ와 상관없이 모든 EC2 인스턴스에게 트래픽을 고르게 분산시킨다.
```

### 14)

> 애플리케이션 로드 밸런서 (ALB)와 네트워크 로드 밸런서 (NLB)의 어떤 기능을 통해 하나의 리스너에서 여러 SSL 인증서를 로드할 수 있을까요?
> 

```
1. TLS Termination
2. Server Name Indication (SNI)
3. SSL Security Policies
4. Host Headers
```

```
선택) 2. Server Name Indication (SNI)
정답) 2. Server Name Indication (SNI)

해설) SNI를 사용하면 하나의 리스너에서 여러 SSL 인증서를 로드할 수 있다. (타겟그룹당 지정 가능)
CLB는 지원하지 않기 때문에 하나의 리스너당 하나의 SSL 인증서만 사용 가능하다.
```

### 15)

> 여러분은 다음 호스트 이름을 기반으로 트래픽을 3개의 대상 그룹으로 리디렉션하도록 구성된 애플리케이션 로드 밸런서 (ALB)가 있습니다: users.example.com, api.external.example.com 및 checkout.example.com. 이러한 각 호스트 이름에 대해 HTTPS를 구성하려고 합니다. 이 작업을 수행하려면 ALB를 어떻게 구성해야 할까요?
> 

```
1. HTTP에서 HTTPS로의 리디렉션 규칙 사용
2. 보안 그룹 SSL 인증서 사용
3. Server Name Indication (SNI) 사용
```

```
선택) 3. Server Name Indication (SNI) 사용
정답) 3. Server Name Indication (SNI) 사용

해설) SNI를 사용하면 하나의 리스너에서 자체 SSL 인증서가 있는 애플리케이션을 노출할 수 있다.
refer. https://aws.amazon.com/blogs/aws/new-application-load-balancer-sni/
```

### 16)

> 여러분은 원하는 용량과 최대 용량을 모두 3으로 구성한 오토 스케일링 그룹 (ASG)에서 관리하는 EC2 인스턴스 세트에서 호스팅되는 애플리케이션이 있습니다. 또한 CPU 사용률이 60%에 도달하면 ASG를 스케일링하도록 구성된 CloudWatch 경보를 생성했습니다. 여러분의 애플리케이션은 갑자기 엄청난 트래픽을 수신했고 현재 80% CPU 사용률로 실행되고 있습니다. 이제 무슨 일이 일어날까요?
> 

```
1. 아무일도 일어나지 않습니다
2. 원하는 용량은 최대 4개, 최대 용량은 3개로 유지됩니다.
3. 원하는 용량은 최대 4개로 증가하고 최대 용량은 4개로 유지됩니다.
```

```
선택) 1. 아무일도 일어나지 않습니다
정답) 1. 아무일도 일어나지 않습니다

해설) ASG에서 최대 용량, 최소 용량은 사용자가 설정한 이후에 자동으로 바뀌지 않기 때문에 경보가 울려도 최대 용량을 넘기지 않는다.
```

### 17)

> 여러분은 애플리케이션 로드 밸런서 (ALB)가 전면에 있는 오토 스케일링 그룹이 있습니다. ALB 상태 확인을 사용하도록 ASG를 구성했는데 하나의 EC2 인스턴스가 비정상으로 보고되었습니다. 이 EC2 인스턴스는 어떻게 될까요?
> 

```
1. ASG는 인스턴스를 계속 실행하고 애플리케이션을 다시 시작합니다.
2. ASG는 EC2 인스턴스를 분리하고 계속 실행합니다.
3. ASG는 EC2 인스턴스를 종료합니다.
```

```
선택) 3. ASG는 EC2 인스턴스를 종료합니다.
정답) 3. ASG는 EC2 인스턴스를 종료합니다.

해설) ELB를 기반으로 상태확인이 가능하다. 만약 unhealthy로 표시되면 기존 인스턴스는 종료하고 새로운 인스턴스를 띄운다.
```

### 18)

> 여러분의 상사는 애플리케이션이 데이터베이스에 대해 수행하는 분당 요청 수를 기반으로 오토 스케일링 그룹을 스케일링하도록 요청했습니다. 어떻게 해야 할까요?
> 

```
1. CloudWatch 사용자 지정 지표를 생성한 다음 이 지표에 대한 CloudWatch 경보를 생성하여 ASG를 스케일링합니다.
2. 정중하게 불가능하다고 전합니다.
3. 세부 모니터링을 활성화한 다음 CloudWatch 경보를 생성하여 ASG를 스케일링합니다.
```

```
선택) 1. CloudWatch 사용자 지정 지표를 생성한 다음 이 지표에 대한 CloudWatch 경보를 생성하여 ASG를 스케일링합니다.
정답) 1. CloudWatch 사용자 지정 지표를 생성한 다음 이 지표에 대한 CloudWatch 경보를 생성하여 ASG를 스케일링합니다.

해설) "데이터베이스에 대해 수행하는 분당 요청 수"는 CloudWatch에 없기 때문에 사용자 지정 지표를 생성해야한다.
```

### 19)

> 오토 스케일링 그룹 (ASG)에서 관리하는 EC2 인스턴스 플릿이 호스팅하는 웹 애플리케이션이 있습니다. 여러분은 애플리케이션 로드 밸런서 (ALB)를 통해 이 애플리케이션을 노출하고 있습니다. EC2 인스턴스와 ALB는 모두 다음 CIDR `192.168.0.0/18`을 사용하여 VPC에 배포됩니다. ALB만 포트 `80`에서 액세스할 수 있도록 EC2 인스턴스의 보안 그룹을 구성하려면 어떻게 해야 할까요?
> 

```
1. 포트 80 및 0.0.0.0/0을 소스로 사용하여 인바운드 규칙 추가
2. 포트 80 및 192.168.0.0/18을 소스로 사용하여 인바운드 규칙 추가
3. 포트 80 및 ALB의 보안 그룹을 소스로 사용하여 인바운드 규칙 추가
4. ALB에서 SSL 인증서 로드
```

```
선택) 3. 포트 80 및 ALB의 보안 그룹을 소스로 사용하여 인바운드 규칙 추가
정답) 3. 포트 80 및 ALB의 보안 그룹을 소스로 사용하여 인바운드 규칙 추가

해설) ALB에는 모두 허용하게 하고, EC2에는 ALB에서 들어오는 트래픽만 허용하게 보안그룹을 소스로 지정하는게 가장 안전한 방법이다.
```

### 20)

> `eu-west-2` 리전에서 실행 중인 오토 스케일링 Configured가 있으며 `eu-west-2a` 및 `eu-west-2b` 가용 영역 두 개를 생성하도록 구성되어 있습니다. 현재 `eu-west-2a`에서 EC2 인스턴스 3개와 `eu-west-2b`에서 EC2 인스턴스 4개가 실행 중입니다. ASG가 곧 축소됩니다. 어떤 EC2 인스턴스가 종료될까요?
> 

```
1. eu-west-2a의 임의 EC2 인스턴스
2. 가장 오래된 런치 템플릿 버전이 있는 eu-west-2a의 EC2 인스턴스
3. eu-west-2b의 임의 EC2 인스턴스
4. 가장 오래된 런치 템플릿 버전이 있는 eu-west-2b의 EC2 인스턴스
```

```
선택) 4. 가장 오래된 런치 템플릿 버전이 있는 eu-west-2b의 EC2 인스턴스
정답) 4. 가장 오래된 런치 템플릿 버전이 있는 eu-west-2b의 EC2 인스턴스

해설) ASG의 기본 종료 정책은 1. 가장 많은 인스턴스가 있는 AZ에서 2. 가장 오래된 런치 템플릿의 인스턴스를 종료한다.
```

### 21)

> 애플리케이션은 애플리케이션 로드 밸런서 (ALB) 및 오토 스케일링 그룹과 함께 배포됩니다. 현재 ASG를 수동으로 스케일링하고 EC2 인스턴스에 대한 평균 연결 수가 약 1000개인지 확인하는 스케일링 정책을 정의하려고 합니다. 어떤 스케일링 정책을 사용해야 할까요?
> 

```
1. 단순 스케일링 정책
2. 단계 스케일링 정책
3. 대상 추적 정책
4. 예약 스케일링 정책
```

```
선택) 3. 대상 추적 정책
정답) 3. 대상 추적 정책

해설) CloudWatch에서 지원해주는 대상 추적 정책을 사용하면 수치에 기반한 조정이 가능하다.
```

### 22)

> 오토 스케일링 그룹 (ASG)가 관리하는 EC2 인스턴스에서 호스팅되는 애플리케이션이 갑자기 트래픽 급증을 수신하여 ASG가 스케일링되고 새 EC2 인스턴스가 시작되었습니다. 트래픽은 지속적으로 증가하지만 ASG는 새 EC2 인스턴스를 즉시 시작하지 않고 5분 후에 시작합니다. 이 동작이 가능한 원인은 무엇일까요?
> 

```
1. 쿨다운 기간
2. 수명 주기 후크
3. 대상 추적 정책
4. 템플릿 시작
```

```
선택) 1. 쿨다운 기간
정답) 1. 쿨다운 기간

해설) 인스턴스가 안정화될때까지의 기간인 쿨다운 기간동안은 인스턴스를 시작하거나 종료하지 않는다.
```

### 23)

> 여러분의 회사에는 지난 달에 임의의 EC2 인스턴스가 갑자기 충돌한 오토 스케일링 그룹 (ASG)이 있습니다. ASG가 비정상 EC2 인스턴스를 종료하고 새 EC2 인스턴스로 교체할 때, EC2 인스턴스가 충돌하는 이유를 알아낼 수 없었습니다. 문제를 해결하고 비정상 인스턴스가 ASG에 의해 종료되는 것을 방지하기 위해 어떻게 해야할까요?
> 

```
1. 종료하기 전에 AWS Lambda를 사용하여 EC2 인스턴스 일시 중지
2. ASG 수명 주기 후크를 사용하여 문제 해결을 위해 종료 중 상태의 EC2 인스턴스를 일시 중지
3. CloudWatch Logs를 사용하여 문제 해결
```

```
선택) 2. ASG 수명 주기 후크를 사용하여 문제 해결을 위해 종료 중 상태의 EC2 인스턴스를 일시 중지
정답) 2. ASG 수명 주기 후크를 사용하여 문제 해결을 위해 종료 중 상태의 EC2 인스턴스를 일시 중지

해설) 수명 주기후크를 사용하면 인스턴스가 시작하는 중, 종료하는 중에 특정 액션을 취할 수 있다.
```