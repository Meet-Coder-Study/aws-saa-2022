# W9
## Quiz 14: Messaging & Integration Quiz
## Question 4
Question 4:
```
여러분은 SQS 표준 Queues에서 메시지를 처리하는 데 사용되는 오토 스케일링 그룹에서 관리하는 EC2 인스턴스(소비자) 집합이 있습니다. 
최근에 두 번 처리된 많은 메시지를 발견했으며 추가 조사 후에 이러한 메시지를 성공적으로 처리할 수 없음을 발견했습니다. 
이러한 메시지가 실패하는 이유를 어떻게 해결(디버그)하시겠습니까?
```

1. 표준 SQS
2. 배달 못 한 편지 Queue
3. SQS 지연 Queue
4. SQS FIFO Queue

- 선택 : (4)
- 정답 : (2)

<br>

- 문제 포인트
  - 표준 SQS
  - 두번 처리된 메시지들
  - 실패하는 이유를 어떻게 해결하겠는가?

<br>

- 개인 해설
```
중복된 메시지를 처리하는 것이 포인트로 생각하여 중복 처리할 수 없는 FIFO 선택
```
- 정답 해설
```
SQS 배달 못한 편지 Queues은 다른 SQS Queues(소스 Queues)이 성공적으로 처리(소비)되지 않은 메시지를 보낼 수 있는 곳입니다. 
문제가 있는 메시지를 격리하여 처리가 성공하지 못한 이유를 디버깅할 수 있으므로 디버깅에 유용합니다.
```

<br>
<br>

## Question 6
```
동일한 메시지를 보내려는 3개의 서로 다른 애플리케이션이 있습니다. 
3개의 애플리케이션 모두 SQS를 사용하고 있습니다. 어떤 접근 방식을 선택하시겠습니까?
```
1. SQS 복제 기능 사용
2. SNS + SQS 팬아웃 패턴 사용
3. 3개의 SQS Queues에 개별적으로 메시지 보내기

- 선택 : (2)
- 정답 : (2)

<br>

- 문제 포인트
  - 동일한 메시지
  - 3개의 어플리케이션

<br>

- 개인 해설
```
동일한 메시지를 서로 다른 어플리케이션에 보내야한다.
SNS와 SQS를 함께 사용하면 즉각적인 이벤트 알림을 필요로 하는 애플리케이션에 메시지를 전송할 수 있고, 
다른 애플리케이션에서 나중에 처리할 수 있도록 메시지를 SNS 대기열에 계속 보관할 수도 있다.
```

- 정답 해설 
```
이것은 하나의 메시지만 SNS 주제로 보낸 다음 여러 SQS Queues로 "팬아웃"되는 일반적인 패턴입니다. 
이 접근 방식에는 다음과 같은 기능이 있습니다. 완전히 분리되고 데이터 손실이 없으며 시간이 지남에 따라 더 많은 SQS Queues(더 많은 애플리케이션)을 추가할 수 있습니다.
```
- fan out : Publisher는 메세지를 발행하고 이 메세지들은 수많은 Subscribers(구독자들)에게 전달될 수 있음을 뜻함.

<br>
<br>

## Question 7
```
여러분은 6개의 샤드가 프로비저닝된 Kinesis 데이터 스트림이 있습니다. 이 데이터 스트림은 일반적으로 5MB/s의 데이터를 수신하고 8MB/s를 전송합니다. 
때때로 트래픽이 최대 2배까지 급증하고 ProvisionedThroughputExceededException 예외가 발생합니다. 
문제를 해결하려면 어떻게 해야 할까요?
```
1. 더 많은 샤드를 추가
2. Kinesis 복제 활성화
3. SQS Kinesis에 대한 버퍼로 사용

선택 : (1)
정답 : (1)

- 문제 포인트
  - 6개의 샤드
  - 5MB/s의 데이터를 수신하고 8MB/s를 전송
  - ProvisionedThroughputExceededException

<br>

- 개인 해설
```
스트림의 데이터 용량은 해당 샤드 용량의 합계이다.
각 샤드는 1MB/s 및 초당 1,000개의 레코드를 수집하고 최대 2MB/s까지 송신이 가능한데
6개의 샤드에서 트래픽이 증가할 때 처리량 예외가 발생한다고 한다.
6개의 샤드로는 최대 12MB까지 처리가 가능한데 트래픽이 2배 증가하면 16MB를 처리를 못하기 때문에
샤드를 늘려야한다고 생각.
```
- 문제 해설
```
Kinesis 데이터 스트림의 용량 제한은 데이터 스트림 내의 샤드 수로 정의됩니다.
데이터 처리량 또는 읽기 데이터 호출 수로 인해 제한을 초과할 수 있습니다.
각 샤드는 1MB/s의 들어오는 데이터와 2MB/s의 나가는 데이터를 허용합니다.
충분한 용량을 제공하려면 데이터 스트림 내의 샤드 수를 늘려야 합니다.
```
- [ProvisionedThroughputExceededException](https://docs.aws.amazon.com/ko_kr/amazondynamodb/latest/developerguide/Programming.Errors.html)
  - DynamoDB 관련 에러
  - 테이블 또는 하나 이상의 글로벌 보조 인덱스에게 허용되는 최대 프로비저닝된 처리량 초과시 발생하는 런타임 에러

<br>
<br>


